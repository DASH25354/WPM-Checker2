<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WPM Quiz with Audio</title>
<style>
  body { font-family: Arial, sans-serif; padding: 30px; }
  #text { border: 1px solid #ccc; padding: 30px; margin-bottom: 30px; background: #f9f9f9; }
  #controls { margin: 30px 0; }
  #questions { margin-top: 30px; }
</style>
</head>
<body>

<h2>Three-minute Training</h2>

<style>
  audio {
    display: block;      /* ブロック表示にして余白を効かせる */
    margin-bottom: 3em;  /* 下に3行分の余白 */
  }
</style>
  
<!-- 音声再生 -->
<h3>Listen to the audio:</h3>
<audio controls>
  <source src="2.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>

  
<!-- テキスト -->
<div id="text">
【2】The Osaka-Kansai Expo started in April with the theme “Designing Future Society for Our Lives.” Now, there are only 15 days left until the Expo closes next month. Up to June 27, more than 22 million people visited the Expo. This is more than the number needed for a positive budget. Every day, over 200,000 people visit. If this continues, about 25 million people will visit in total. This number will be higher than the Expo held in Aichi in 2005. At this Expo, people must book a date and time before coming. Now, most of the tickets for the final days are taken. Many people are trying to visit before the closing. The organizers say tickets cannot be refunded, so people with unused tickets have a problem at the end.
</div>

<!-- スタート・フィニッシュボタン -->
<div id="controls">
  <button onclick="startReading()">▶ Start</button>
  <button onclick="finishReading()">⏹ Finish</button>
</div>

<!-- 4択クイズ -->
<div id="questions">
  <h3>Quiz</h3>
  <label>Select all options below that match the content of the passage.</label><br>
  <input type="checkbox" class="q1" value="a"> The Expo will continue for another two months.
<br>
  <input type="checkbox" class="q1" value="b"> People need to book a date and time before visiting the Expo.
<br>
  <input type="checkbox" class="q1" value="c"> All tickets can be refunded at any time.
<br>
  <input type="checkbox" class="q1" value="d"> More people have visited than the number needed for a positive budget.
<br>
</div>

<div id="result"></div>

<script>
let startTime;
let wordCount = 0;

function startReading() {
  const text = document.getElementById("text").innerText.trim();
  wordCount = text.split(/\s+/).length;
  startTime = Date.now();
  document.getElementById("result").innerText = "Reading started...";
}

function finishReading() {
  if (!startTime) return alert("Please start reading first!");
  const elapsedSec = (Date.now() - startTime) / 1000;

  // 正答の配列（複数正解対応）
  const correctAnswers = ["b","d"];

  // 選択されたチェックボックスを取得
  const checked = Array.from(document.querySelectorAll(".q1:checked")).map(el => el.value);

  // 正答数計算（余分に選んだものもペナルティにする場合は調整可能）
  const numCorrect = checked.filter(val => correctAnswers.includes(val)).length;

  // 正答率 = 選択された正答の割合
  const accuracy = numCorrect / correctAnswers.length;

  const rawWPM = (wordCount / elapsedSec) * 60;
  const finalWPM = Math.round(rawWPM * accuracy);

  document.getElementById("result").innerHTML =
    `Time: ${elapsedSec.toFixed(1)} sec<br>` +
    `Raw WPM: ${rawWPM.toFixed(1)}<br>` +
    `Accuracy: ${(accuracy*100).toFixed(0)}%<br>` +
    `Final WPM (accuracy applied): ${finalWPM}`;
}
</script>

</body>
</html>



