<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WPM Quiz with Audio</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body { 
    font-family: Arial, sans-serif; 
    padding: 30px; 
    font-size: 1.5em;
    padding-top: 140px; /* PCデフォルト */
    box-sizing: border-box;
  }

  h2, h3 {
    font-size: 1.5em;
  }

  audio {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    transform: scale(1.5);
    transform-origin: top left;
    z-index: 1000;
    background: #fff;
    padding: 10px 0;
    box-sizing: border-box;
  }

  button {
    font-size: 1.5em; 
    padding: 15px 30px;
    margin: 10px;
  }

  input[type="checkbox"] {
    transform: scale(1.5);
    margin-right: 10px;
  }

  #text { 
    border: 1px solid #ccc; 
    padding: 30px; 
    margin-bottom: 30px; 
    background: #f9f9f9; 
  }

  #controls { margin: 30px 0; }
  #questions { margin-top: 30px; }

  /* チェックボックスの選択肢に余白をあける */
  .question-option {
    display: block;
    margin-bottom: 18px; /* 好みで調整、1行分空ける */
  }

  /* --- モバイル用スタイル --- */
  @media (max-width: 600px) {
    body { 
      padding-top: 70px; /* オーディオ分の余白を小さく */
      font-size: 1.1em;
    }
    audio {
      transform: none;    /* 拡大せず標準サイズ */
      height: 44px;       /* iOSやAndroid標準UIに合わせる */
      top: 8px;           /* アドレスバーを避けて少し下げる */
      padding: 0;
    }
    #text { padding: 15px; }
    button {
      font-size: 1em;
      padding: 10px 16px;
    }
    input[type="checkbox"] {
      transform: scale(1.2);
    }
    /* モバイルでもチェックボックス選択肢に余白を */
    .question-option {
      margin-bottom: 16px;
    }
  }
</style>
</head>
<body>

<h2>Three-minute Training</h2>

<!-- 音声再生 -->
<audio controls>
  <source src="2.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>
  
<!-- テキスト -->
<div id="text">
【2】The Osaka-Kansai Expo started in April with the theme “Designing Future Society for Our Lives.” Now, there are only 15 days left until the Expo closes next month. Up to June 27, more than 22 million people visited the Expo. This is more than the number needed for a positive budget. Every day, over 200,000 people visit. If this continues, about 25 million people will visit in total. This number will be higher than the Expo held in Aichi in 2005. At this Expo, people must book a date and time before coming. Now, most of the tickets for the final days are taken. Many people are trying to visit before the closing. The organizers say tickets cannot be refunded, so people with unused tickets have a problem at the end.</div>

<div id="controls">
  <button onclick="startReading()">▶ Start</button>
  <button onclick="finishReading()">⏹ Finish</button>
</div>

<div id="questions">
  <h3>Quiz</h3>
  <label>Select all options below that match the content of the passage.</label></span>
  <span class="question-option"><input type="checkbox" class="q1" value="a"> The Expo will continue for another two months.
</span>
  <span class="question-option"><input type="checkbox" class="q1" value="b"> People need to book a date and time before visiting the Expo.
</span>
  <span class="question-option"><input type="checkbox" class="q1" value="c"> All tickets can be refunded at any time.</span>
  <span class="question-option"><input type="checkbox" class="q1" value="d"> More people have visited than the number needed for a positive budget.
</span>
</div>

<div id="result"></div>

<script>
let startTime;
let wordCount = 0;

function startReading() {
  const text = document.getElementById("text").innerText.trim();
  wordCount = text.split(/\s+/).length;
  startTime = Date.now();
  document.getElementById("result").innerText = "Reading started...";
}

function finishReading() {
  if (!startTime) return alert("Please start reading first!");
  const elapsedSec = (Date.now() - startTime) / 1000;

  const correctAnswers = ["b","d"];
  const checked = Array.from(document.querySelectorAll(".q1:checked")).map(el => el.value);
  const numCorrect = checked.filter(val => correctAnswers.includes(val)).length;
  const accuracy = numCorrect / correctAnswers.length;

  const rawWPM = (wordCount / elapsedSec) * 60;
  const finalWPM = Math.round(rawWPM * accuracy);

  document.getElementById("result").innerHTML =
    `Time: ${elapsedSec.toFixed(1)} sec<br>` +
    `Raw WPM: ${rawWPM.toFixed(1)}<br>` +
    `Accuracy: ${(accuracy*100).toFixed(0)}%<br>` +
    `Final WPM (accuracy applied): ${finalWPM}`;
}
</script>

</body>
</html>
